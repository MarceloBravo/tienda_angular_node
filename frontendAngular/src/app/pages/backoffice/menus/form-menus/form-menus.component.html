<app-modal-dialog 
    [titulo]="tituloModal"
    [mensaje]="mensajeModal"
    [showModal]="mostrarModal"
    (cancelarClick)="responseModal($event)"
    (aceptarClick)="responseModal($event)"
></app-modal-dialog>

<app-alert></app-alert>

<div class="col-12">
    <div class="card">
        <div class="card-header">
            <h5 class="card-title titulo-form">Mantenedor de menús</h5>
        </div>
        <div class="card-body">
            <form [formGroup]="form">
                <div class="mb-3 row">
                    <label class="col-form-label col-sm-2 text-sm-right">Nombre:</label>
                    <div class="col-sm-10 col-md-5">
                        <input type="text" class="form-control" placeholder="Nombre" formControlName="nombre">
                        
                        <small class="error-message row" *ngIf="hasError('nombre','required')">El nombre del menú es obligatorio.</small>
                        <small class="error-message row" *ngIf="hasError('nombre','minlength')">El nombre del menú debe tener almenos 3 carácteres.</small>
                        <small class="error-message row" *ngIf="hasError('nombre','maxlength')">El nombre del menú debe tener un máximo de 50 carácteres.</small>
                        
                    </div>
                    
                </div>
                <div class="mb-3 row">
                    <label class="col-form-label col-sm-2 text-sm-right">Menú padre:</label>
                    <div class="col-sm-10 col-md-5">
                        <select class="form-control col-md-12" formControlName="menuPadreId">
                            <option selected [value]="null"> -- Sin menú padre --</option>
                            <option *ngFor="let mnu of menusPadres" [value]="mnu.id">
                                {{mnu.nombre}}
                            </option>
                        </select>
                        
                    </div>
                </div>
                <div class="mb-3 row">
                    <label class="col-form-label col-sm-2 text-sm-right">Link o url:</label>
                    <div class="col-sm-10 col-md-5">
                        <input type="text" class="form-control" placeholder="Link o URL destino" formControlName="link">

                        <small class="error-message row" *ngIf="hasError('link','minlength')">El link del menú debe tener almenos 3 carácteres.</small>
                        <small class="error-message row" *ngIf="hasError('link','maxlength')">El link del menú debe tener un máximo de 250 carácteres.</small>
                    </div>
                </div>
                <div class="mb-3 row">
                    <label class="col-form-label col-sm-2 text-sm-right">Posición:</label>
                    <div class="col-md-2 col-sm-8">
                        <input type="number" class="form-control" placeholder="Posición" min="0" formControlName="posicion">

                        <small class="error-message row" *ngIf="hasError('posicion','required')">La posición del menú es obligatoria.</small>
                        <small class="error-message row" *ngIf="hasError('posicion','min')">La posición no puede ser un valor negativo.</small>
                    </div>
                </div>
                <div class="mb-3 row">
                    <label class="col-form-label col-sm-2 text-sm-right">Icono:</label>
                    <div class="col-md-2 col-sm-10">
                        <img #iconoImg id="iconoImg" class="form-control-image" src="#">
                        <button class="btn btn-primary btn-load-image" (click)="selectImage(iconoFile)">Cargar icono</button>
                        <input #iconoFile id="btn-file" type="file" class="form-control-file" accept="*.jpg, *.png" formControlName="icono" (change)="loadImage(iconoFile, iconoImg)">
                    </div>
                </div>
                
                <div class="mb-3 row">
                    <app-mnt-buttons (successClick)="save()" (dangerClick)="delete()" (cancelClick)="cancelar()" [btnSuccessEnabled]="form.valid" [btnDangerEnabled]="form.value.id !== null"></app-mnt-buttons>
                </div>
            </form>
        </div>
    </div>
</div>